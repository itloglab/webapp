# AS 관리 - 화면 정의서

## 1. 화면 개요

### 1.1 기본 정보
- **화면명**: AS 관리
- **목적**: AS 목록 조회, AS 접수, AS 상세 확인, AS 상태 관리

---

## 2. 초기 로드

### 2.1 초기 데이터 로드
- 전체 AS 목록 조회
- 최신순 정렬
- 페이징: 50건씩

### 2.2 초기 화면 상태
- 상태 필터: "상태 전체" 선택
- 현장 필터: "현장 전체" 선택
- 문제유형 필터: "문제유형 전체" 선택
- 검색어: 비어있음
- 요약 영역: 통계 표시

---

## 3. 검색/필터 영역

### 3.1 상태 필터
**필터 옵션:**
- 상태 전체 (기본값)
- 접수
- 회수
- 수리중
- 완료

**동작:**
- 드롭다운 선택 시 즉시 필터 적용

---

### 3.2 현장 필터
**필터 옵션:**
- 현장 전체 (기본값)
- 등록된 현장 목록

**동작:**
- 특정 현장 선택 시 해당 현장의 AS만 표시

---

### 3.3 문제유형 필터
**필터 옵션:**
- 문제유형 전체 (기본값)
- 초기 불량
- 고장
- 파손
- 오작동
- 기타

**동작:**
- 선택한 문제유형의 AS만 표시

---

### 3.4 검색 기능
**검색 대상:**
- AS 번호
- 자재명
- 통합 검색 (OR 조건)

**[검색] 버튼 클릭 시:**
- 검색 실행
- 결과 테이블 업데이트

---

### 3.5 초기화 기능
**[초기화] 버튼 클릭 시:**
- 모든 필터 "전체"로 리셋
- 검색 입력 필드 초기화
- 전체 목록 재조회

---

## 4. 요약 영역

### 4.1 통계 표시
```
접수: 5건 | 회수: 3건 | 수리중: 2건 | 완료: 45건 | 평균 처리: 2.3일
```

**통계 항목:**
- **접수**: 접수 완료, 회수 대기
- **회수**: 현장에서 회수 완료
- **수리중**: 수리/검수 진행 중
- **완료**: 재출고 또는 폐기 완료
- **평균 처리**: 접수 ~ 완료까지 평균 소요일

**특징:**
- 실시간 업데이트

---

### 4.2 [+ 새 AS 접수] 버튼
**위치:** 요약 영역 우측

**클릭 시:**
- AS 접수 모달 오픈
- 폼 필드 초기화

---

## 5. 목록 테이블

### 5.1 컬럼 구조
| 컬럼명 | 표시 내용 | 비고 |
|--------|----------|------|
| AS 번호 | AS-2024-001 | 굵게 표시 |
| 현장 | 강남 오피스텔 | |
| 자재 | IP카메라 2MP | |
| 문제 유형 | 초기 불량 | |
| 접수일 | 2024-01-20 | |
| 경과 | 3일 | 현재 - 접수일 |
| 상태 | 뱃지 (접수/회수/수리중/완료) | 색상 구분 |
| 작업 | - | |

---

### 5.2 경과 시간 표시
**계산 방식:**
```
경과 = 현재 날짜 - 접수일
```

**표시 형식:**
- 0일: "0일" (당일)
- 1-3일: "X일" (정상, 검은색)
- 4-7일: "X일" (주의, 주황색)
- 8일 이상: "X일" (지연, 빨간색)

---

### 5.3 상태 뱃지
**상태별 색상:**
| 상태 | 색상 | 설명 |
|------|------|------|
| 접수 | 빨간색 | 접수 완료, 회수 대기 |
| 회수 | 파란색 | 현장 회수 완료 |
| 수리중 | 주황색 | 수리/검수 진행 중 |
| 준비완료 | 초록색 | 재출고 준비 완료 |
| 완료 | 회색 | 재출고 또는 폐기 완료 |

---

### 5.4 행 클릭
**트리거:** 테이블 행 클릭

**동작:**
- AS 상세 모달 오픈
- AS 정보 및 처리 이력 로드

---

## 6. AS 상세 모달

### 6.1 오픈 조건
- 테이블 행 클릭

---

### 6.2 표시 정보

**AS 기본 정보:**
- AS 번호
- 상태
- 현장
- 자재 (자재 코드 포함)
- 시리얼 번호
- 문제 유형
- 접수일
- 경과 시간

**문제 설명:**
- 접수 시 입력한 문제 설명

**처리 진행 상황 (타임라인):**
- 시간순 정렬
- 각 처리 단계별 표시:
  - 접수 완료
  - 회수 완료
  - 검수 완료
  - 수리 중
  - 재출고 대기 (예정)

**타임라인 예시:**
```
2024-01-20 10:00
접수 완료 - 이현장

2024-01-21 09:00
회수 완료 - 김창고
현장에서 회수 완료. AS 창고 입고.

2024-01-21 14:00
검수 완료 - 김수리
메인보드 불량 의심.

2024-01-22 09:00
수리 중 - 김수리
메인보드 교체 작업 시작.

예정
재출고 대기
```

---

### 6.3 [상태 변경] 버튼
**위치:** 모달 하단

**클릭 시:**
- AS 상태 변경 모달 오픈

---

### 6.4 [닫기] 버튼
**동작:**
- 모달 닫기

---

## 7. AS 접수 모달

### 7.1 모달 오픈
**트리거:**
- [+ 새 AS 접수] 버튼 클릭

---

### 7.2 입력 필드

**필수 입력 (*):**
- 현장* (드롭다운)
- 자재* (입력)
- 문제 유형* (드롭다운)
- 접수일* (날짜 시간)
- 문제 설명* (텍스트)

**선택 입력:**
- 발주 (드롭다운)
- 시리얼 번호 (입력)
- 접수자 (입력, 기본값: 현재 사용자)

---

### 7.3 현장 선택
**드롭다운:**
- 등록된 현장 목록
- 현장명 + 프로젝트 번호 표시

**선택 시:**
- 해당 현장의 발주 목록 로드 (발주 드롭다운)

---

### 7.4 발주 선택 (선택)
**드롭다운:**
- 선택한 현장의 발주 목록
- 발주번호 + 견적명 표시

**용도:**
- AS 원인 추적
- 발주 연결

---

### 7.5 자재 입력
**입력 방식:**
- 직접 입력 또는 Autocomplete (선택)

**표시:**
- 자재명 입력

---

### 7.6 시리얼 번호 입력 (선택)
**입력 방식:**
- 직접 입력

**용도:**
- 시리얼 추적
- 시리얼 상태 자동 변경 연동

---

### 7.7 문제 유형 선택
**드롭다운 옵션:**
- 초기 불량
- 고장
- 파손
- 오작동
- 기타

---

### 7.8 접수일 입력
**입력 방식:**
- 날짜 시간 선택 (datetime-local)

**기본값:**
- 현재 날짜 시간

---

### 7.9 문제 설명 입력
**입력 방식:**
- Textarea (여러 줄)

**용도:**
- 문제 상황 상세 기록
- 수리 담당자 참고

---

### 7.10 [접수 등록] 버튼

**유효성 검증:**

**1단계: 필수 필드 검증**
- 현장 선택 확인
- 자재 입력 확인
- 문제 유형 선택 확인
- 문제 설명 입력 확인

**동작 순서:**
1. 필수 필드 검증
2. AS 접수 처리
3. AS 번호 자동 생성
   - 형식: AS + - + YYYY + - + 일련번호
   - 예: AS-2024-001
4. 초기 상태: "접수"로 설정
5. 처리 이력 자동 기록 (접수 완료)
6. 시리얼 번호 입력 시: 시리얼 상태 변경 (AS 입고 예정)
7. 성공 알림: "AS가 접수되었습니다"
8. 모달 닫기
9. 목록 갱신

---

### 7.11 [취소] 버튼
**동작:**
- 확인 메시지: "접수를 취소하시겠습니까?"
- 확인 시: 모달 닫기
- 취소 시: 모달 유지

---

## 8. AS 상태 변경 모달

### 8.1 모달 오픈
**트리거:**
- AS 상세 모달의 [상태 변경] 버튼 클릭

---

### 8.2 표시 정보
**AS 정보 (읽기 전용):**
- AS 번호
- 현장
- 자재
- 현재 상태

---

### 8.3 입력 필드

**변경할 상태 (라디오 버튼):**
- 접수
- 회수
- 수리중
- 준비완료
- 완료

**기본 선택:**
- 다음 단계 상태로 자동 선택
  - 접수 → 회수
  - 회수 → 수리중
  - 수리중 → 준비완료
  - 준비완료 → 완료

**처리 내용 (텍스트, 선택):**
- 상태 변경 사유 및 처리 내용 입력
- 예: "현장 회수 완료", "메인보드 교체 완료"

---

### 8.4 [상태 변경] 버튼

**유효성 검증:**
1. 변경할 상태 선택 확인
   - 미선택 시: "변경할 상태를 선택해주세요" 알림

**동작 순서:**
1. 상태 선택 검증
2. 상태 변경 처리
3. 처리 이력 자동 기록
   - 변경 시간, 변경자, 처리 내용
4. 시리얼 상태 자동 변경 (해당 시)
   - 회수 → AS 입고
   - 완료 → 재출고 또는 폐기
5. 목록의 상태 뱃지 즉시 갱신
6. 성공 알림: "AS 상태가 변경되었습니다"
7. 모달 닫기

---

### 8.5 [취소] 버튼
**동작:**
- 모달 닫기
- 변경사항 없음

---

## 9. 유효성 검증 규칙

### 9.1 AS 접수 필수 필드
- 현장 선택
- 자재 입력
- 문제 유형 선택
- 접수일
- 문제 설명

---

### 9.2 상태 변경 검증
- 변경할 상태 선택 확인
- 미선택 시: "변경할 상태를 선택해주세요"

---

## 10. 상태 정의 및 흐름

### 10.1 AS 상태

| 상태 | 설명 |
|------|------|
| 접수 | AS 접수 완료, 현장 회수 대기 |
| 회수 | 현장에서 회수 완료, AS 창고 입고 |
| 수리중 | 검수 및 수리 진행 중 |
| 준비완료 | 수리 완료, 재출고 준비 완료 |
| 완료 | 재출고 완료 또는 폐기 완료 |

---

### 10.2 상태 흐름
```
접수 → 회수 → 수리중 → 준비완료 → 완료
```

**상태 변경 규칙:**
- 순차적 진행 권장
- 역방향 변경 가능
- 건너뛰기 가능 (예외적)

---

### 10.3 상태별 처리 내용

**접수:**
- AS 접수 등록
- 처리 이력: "접수 완료"

**회수:**
- 현장에서 자재 회수
- AS 창고 입고
- 시리얼 위치 변경 (현장 → AS 창고)
- 처리 이력: "회수 완료"

**수리중:**
- 검수 및 수리 진행
- 처리 이력: "검수 완료", "수리 중"

**준비완료:**
- 수리 완료
- 재출고 준비
- 처리 이력: "수리 완료"

**완료:**
- 재출고 또는 폐기
- 시리얼 위치 변경 (AS 창고 → 현장 또는 폐기)
- 처리 이력: "재출고 완료" 또는 "폐기 완료"

---

## 11. 에러 처리

### 11.1 사용자 입력 오류

| 상황 | 메시지 | 동작 |
|------|--------|------|
| 필수 필드 누락 | "필수 항목을 모두 입력해주세요" | 해당 필드 포커스 |
| 상태 미선택 | "변경할 상태를 선택해주세요" | - |

---

## 12. 비즈니스 규칙

### 12.1 AS 번호 생성
- 자동 생성 (수동 입력 불가)
- 형식: AS + - + YYYY + - + 일련번호
- 예: AS-2024-001
- 연도별 순번 관리

---

### 12.2 평균 처리 시간 계산
```
평균 처리 시간 = Σ(완료일 - 접수일) / 완료 건수
```

**표시 단위:**
- 일 단위 (소수점 1자리)

---

### 12.3 시리얼 상태 자동 변경

**AS 접수 시:**
- 시리얼 번호 입력 시: 시리얼 상태 "AS 입고 예정"

**회수 완료 시:**
- 시리얼 위치: 현장 → AS 창고
- 시리얼 상태: "AS 입고"

**완료 시:**
- 재출고: 시리얼 위치 AS 창고 → 현장
- 폐기: 시리얼 상태 "폐기"

---

### 12.4 처리 이력 자동 기록
**기록 시점:**
- AS 접수 시
- 상태 변경 시

**기록 내용:**
- 일시
- 처리 단계 (접수/회수/검수/수리/완료)
- 담당자
- 처리 내용 (입력 시)

---

### 12.5 경과 시간 색상 규칙
```
0-3일: 정상 (검은색)
4-7일: 주의 (주황색)
8일 이상: 지연 (빨간색)
```

**알림 (선택):**
- 7일 이상 경과 시: 담당자에게 알림

---

## 13. 화면 흐름도

### 13.1 AS 접수 흐름
```
[+ 새 AS 접수] 클릭
    ↓
AS 접수 모달 오픈
    ↓
현장 선택
    ↓
발주 선택 (선택)
    ↓
자재 입력
    ↓
시리얼 번호 입력 (선택)
    ↓
문제 유형 선택
    ↓
접수일 입력
    ↓
문제 설명 입력
    ↓
접수자 입력
    ↓
[접수 등록] 클릭
    ↓
필수 필드 검증
    ↓
AS 접수 처리
    ↓
AS 번호 자동 생성
    ↓
상태: "접수" 설정
    ↓
처리 이력 기록
    ↓
시리얼 상태 변경 (해당 시)
    ↓
성공 알림
    ↓
목록 갱신
```

---

### 13.2 AS 상태 변경 흐름
```
AS 상세 모달 오픈
    ↓
[상태 변경] 버튼 클릭
    ↓
AS 상태 변경 모달 오픈
    ↓
변경할 상태 선택
    ↓
처리 내용 입력 (선택)
    ↓
[상태 변경] 클릭
    ↓
상태 선택 검증
    ↓
상태 변경 처리
    ↓
처리 이력 기록
    ↓
시리얼 상태 변경 (해당 시)
    ↓
목록 뱃지 즉시 갱신
    ↓
성공 알림
```

---

## 14. 개발 체크리스트

### 14.1 필수 구현 사항
- [ ] AS 목록 조회 (페이징)
- [ ] 검색 (AS번호/자재명)
- [ ] 다중 필터 (상태/현장/문제유형)
- [ ] AS 접수 모달
- [ ] AS 상세 모달 (처리 이력 타임라인)
- [ ] AS 상태 변경 모달
- [ ] 경과 시간 색상 구분
- [ ] 평균 처리 시간 계산

---

### 14.2 유효성 검증
- [ ] 필수 필드 검증
- [ ] 상태 선택 검증

---

### 14.3 사용자 경험
- [ ] 타임라인 형식으로 처리 이력 표시
- [ ] 경과 시간 색상으로 긴급도 표시
- [ ] 다음 단계 상태 자동 선택
- [ ] 성공/실패 알림 명확히

---

### 14.4 비즈니스 로직
- [ ] AS 번호 자동 생성
- [ ] 처리 이력 자동 기록
- [ ] 시리얼 상태 자동 변경
- [ ] 시리얼 위치 자동 변경
- [ ] 평균 처리 시간 자동 계산
- [ ] 경과 시간 색상 자동 적용

---

## 15. 주의사항

### 15.1 반드시 지켜야 할 사항
1. **처리 이력 누락 없이 기록** ⭐⭐⭐
   - 모든 상태 변경 시 이력 기록 필수
   
2. **시리얼 상태 동기화**
   - AS 상태 변경 시 시리얼 상태 자동 변경
   - 위치 정보 정확히 업데이트
   
3. **경과 시간 정확성**
   - 실시간 계산
   - 색상 구분 정확히

---

### 15.2 사용자 경험 개선
1. 타임라인으로 진행 상황 시각화
2. 경과 시간 색상으로 긴급도 표시
3. 다음 단계 상태 자동 선택으로 편의성 향상
4. 에러 메시지 명확히

---

### 15.3 데이터 일관성
1. AS 상태와 시리얼 상태 일치
2. 처리 이력 시간순 정렬
3. 시리얼 위치 정보 정확히
4. 평균 처리 시간 정확히 계산

---

## 16. 참고 사항

### 16.1 향후 개선 사항
- AS 처리 알림 자동화
- AS 비용 관리
- AS 통계 대시보드
- AS 보고서 자동 생성
- 고객 알림 (SMS/이메일)

---

### 16.2 관련 화면
- 입고 관리: AS 입고 연동
- 출고 관리: 재출고 연동
- 시리얼 재고: 상태 및 위치 변경
- 현장 통합 현황: AS 현황 조회

---

**작성일:** 2026-02-11  
**작성자:** 기획팀  
**버전:** 1.0 (비즈니스 로직 중심)
