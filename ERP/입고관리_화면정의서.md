# 입고 관리 - 화면 정의서

## 1. 화면 개요

### 1.1 기본 정보
- **화면명**: 입고 관리
- **목적**: 입고 목록 조회, 신규 입고 등록, 입고 검수

---

## 2. 초기 로드

### 2.1 초기 데이터 로드
- 전체 입고 목록 조회
- 최신순 정렬
- 페이징: 50건씩

### 2.2 초기 화면 상태
- 유형 필터: "유형 전체" 선택
- 상태 필터: "상태 전체" 선택
- 창고 필터: "창고 전체" 선택
- 검색어: 비어있음
- 요약 영역: 통계 표시

---

## 3. 검색/필터 영역

### 3.1 유형 필터
**필터 옵션:**
- 유형 전체 (기본값)
- 구매 입고
- 현장 회수
- AS 입고
- 기타 입고

**동작:**
- 드롭다운 선택 시 즉시 필터 적용

---

### 3.2 상태 필터
**필터 옵션:**
- 상태 전체 (기본값)
- 대기
- 검수중
- 완료

**동작:**
- 드롭다운 선택 시 즉시 필터 적용

---

### 3.3 창고 필터
**필터 옵션:**
- 창고 전체 (기본값)
- 본사 창고
- 강남 창고
- AS 창고
- 기타 창고...

**동작:**
- 드롭다운 선택 시 즉시 필터 적용

---

### 3.4 검색 기능
**검색 대상:**
- 입고 번호
- 구매 번호 (PO)
- 자재명
- 통합 검색 (OR 조건)

**[검색] 버튼 클릭 시:**
- 검색 실행
- 결과 테이블 업데이트

---

### 3.5 초기화 기능
**[초기화] 버튼 클릭 시:**
- 모든 필터 "전체"로 리셋
- 검색 입력 필드 초기화
- 전체 목록 재조회

---

## 4. 요약 영역

### 4.1 통계 표시
```
구매: 120건 | 현장 회수: 53건 | AS: 15건 | 기타: 8건
```

**특징:**
- 유형별 건수 표시
- 실시간 업데이트 (입고 시)

---

### 4.2 [+ 신규 입고] 버튼
**위치:** 요약 영역 우측

**클릭 시:**
- 신규 입고 모달 오픈
- 폼 필드 초기화

---

## 5. 목록 테이블

### 5.1 컬럼 구조
| 컬럼명 | 표시 내용 | 비고 |
|--------|----------|------|
| 입고 번호 | IN-2024-050 | 굵게 표시 |
| 유형 | 뱃지 (구매/회수/AS/기타) | 색상 구분 |
| 참조 번호 | PO-2024-001 / OUT-2024-029 | 링크 |
| 발주 | IT260115-01 | 링크 |
| 공급사/현장 | 한화테크윈 / 강남 오피스텔 | |
| 입고일 | 2024-02-03 | |
| 자재 | 2종 60개 | |
| 창고 | 본사 / AS창고 | |
| 상태 | 뱃지 (대기/검수중/완료) | 색상 구분 |
| 작업 | [검수] 버튼 (검수중 시만) | |

---

### 5.2 유형 뱃지
**유형별 색상:**
| 유형 | 색상 | 설명 |
|------|------|------|
| 구매 입고 | 초록색 | 구매 발주 기반 입고 |
| 현장 회수 | 파란색 | 현장에서 회수한 자재 |
| AS 입고 | 주황색 | AS 회수 자재 |
| 기타 입고 | 회색 | 기타 입고 |

---

### 5.3 상태 뱃지
**상태별 색상:**
| 상태 | 색상 | 설명 |
|------|------|------|
| 대기 | 회색 | 검수 대기 중 |
| 검수중 | 주황색 | 검수 진행 중 |
| 완료 | 초록색 | 검수 완료, 재고 반영 |

---

### 5.4 참조 번호 링크
**클릭 시:**
- 구매 입고: PO 상세 화면으로 이동
- 현장 회수: 출고 상세 화면으로 이동
- AS 입고: AS 상세 화면으로 이동

---

### 5.5 행 클릭
**트리거:** 테이블 행 클릭

**동작:**
- 입고 상세 모달 오픈
- 입고 정보 및 자재 목록 로드

**예외:**
- "작업" 컬럼의 버튼 클릭 시에는 행 클릭 무시

---

### 5.6 [검수] 버튼
**표시 조건:**
- 상태가 "검수중"인 경우만 표시

**클릭 시:**
- 입고 검수 모달 오픈
- 자재별 검수 입력 화면 표시

---

## 6. 입고 상세 모달

### 6.1 오픈 조건
- 테이블 행 클릭

---

### 6.2 표시 정보

**입고 기본 정보:**
- 입고 번호
- 입고 유형
- 참조 번호 (PO/출고번호/AS번호)
- 발주 번호
- 공급사 또는 현장
- 입고일
- 입고 창고
- 상태
- 담당자

**입고 자재 목록 (테이블):**
| 자재 코드 | 자재명 | 입고 수량 | 검수 수량 | 불량 수량 | 상태 | AS 회수 여부 |
|----------|--------|----------|----------|----------|------|-------------|

**AS 회수 여부 컬럼:**
- 현장 회수 입고인 경우만 표시
- "AS 회수" 또는 "미사용 반납" 표시

---

### 6.3 [닫기] 버튼
**동작:**
- 모달 닫기

---

### 6.4 [검수 진행] 버튼
**표시 조건:**
- 상태가 "대기" 또는 "검수중"인 경우

**클릭 시:**
- 입고 검수 모달 오픈

---

## 7. 신규 입고 모달

### 7.1 모달 오픈
**트리거:**
- [+ 신규 입고] 버튼 클릭

---

### 7.2 입력 필드

**필수 입력 (*):**
- 입고 유형* (드롭다운)
- 창고* (드롭다운)
- 입고일*

**조건부 필수:**
- **구매 입고 선택 시:**
  - 구매 번호 (PO)* (Autocomplete)
  - 공급사* (자동 입력)
  
- **현장 회수 선택 시:**
  - 출고 번호* (Autocomplete)
  - 현장* (자동 입력)
  - 발주 번호 (자동 입력)
  
- **AS 입고 선택 시:**
  - AS 번호* (Autocomplete)
  - 현장* (자동 입력)

- **기타 입고 선택 시:**
  - 공급사 (직접 입력)

**선택 입력:**
- 담당자
- 비고

---

### 7.3 입고 유형 선택
**옵션:**
- 구매 입고
- 현장 회수
- AS 입고
- 기타 입고

**선택 시 동작:**
- 각 유형에 맞는 입력 필드 표시
- 관련 번호 Autocomplete 활성화

---

### 7.4 자재 목록 입력

**입고 유형별 자재 목록:**

**구매 입고:**
- PO 선택 시 자동으로 발주 자재 목록 로드
- 입고 수량 입력 (기본값: 발주 수량)

**현장 회수:**
- 출고 번호 선택 시 출고 자재 목록 로드
- 회수 수량 입력
- AS 회수 여부 체크박스

**AS 입고:**
- AS 번호 선택 시 AS 자재 표시
- 입고 수량: 1 (고정)

**기타 입고:**
- 자재 Autocomplete로 수동 추가
- 입고 수량 입력

---

### 7.5 [입고 등록] 버튼

**유효성 검증:**

**1단계: 필수 필드 검증**
- 입고 유형 선택 확인
- 창고 선택 확인
- 입고일 입력 확인
- 유형별 필수 필드 확인 (PO/출고/AS 번호)

**2단계: 자재 검증**
- 자재 1개 이상 확인
- 모든 자재 수량 1 이상 확인

**동작 순서:**
1. 필수 필드 검증
2. 자재 검증
3. 입고 등록 처리
4. 입고 번호 자동 생성
   - 형식: IN + - + YYYY + - + 일련번호
   - 예: IN-2024-050
5. 초기 상태: "검수중"으로 설정
6. 성공 알림: "입고가 등록되었습니다"
7. 모달 닫기
8. 목록 갱신

---

### 7.6 [취소] 버튼
**동작:**
- 확인 메시지: "입고 등록을 취소하시겠습니까?"
- 확인 시: 모달 닫기
- 취소 시: 모달 유지

---

## 8. 입고 검수 모달

### 8.1 모달 오픈
**트리거:**
- 목록의 [검수] 버튼 클릭
- 상세 모달의 [검수 진행] 버튼 클릭

---

### 8.2 표시 정보
**입고 정보 (읽기 전용):**
- 입고 번호
- 입고 유형
- 공급사/현장
- 입고일

---

### 8.3 자재별 검수 입력

**검수 테이블:**
| 자재 코드 | 자재명 | 입고 수량 | 정상 수량 | 불량 수량 | 불량 사유 | AS 회수 |
|----------|--------|----------|----------|----------|----------|---------|

**입력 필드:**
- **정상 수량** (필수): 검수 통과 수량
- **불량 수량** (선택): 불량품 수량
- **불량 사유** (불량 시 필수): 드롭다운 또는 텍스트
  - 파손
  - 초기 불량
  - 수량 부족
  - 기타
- **AS 회수** (현장 회수 시만 표시): 체크박스

**자동 검증:**
```
정상 수량 + 불량 수량 = 입고 수량
```

---

### 8.4 [검수 완료] 버튼

**유효성 검증:**

**1단계: 수량 검증**
- 모든 자재: 정상 수량 + 불량 수량 = 입고 수량
- 불일치 시: "검수 수량이 입고 수량과 일치하지 않습니다"

**2단계: 불량 사유 검증**
- 불량 수량 > 0인 경우 불량 사유 필수
- 미입력 시: "불량 사유를 입력해주세요"

**동작 순서:**
1. 수량 검증
2. 불량 사유 검증
3. 검수 완료 처리
4. 상태: "완료"로 변경
5. 재고 반영
   - 정상 수량: 재고 증가
   - 불량 수량: 불량 재고로 분류 또는 별도 처리
6. AS 회수 체크 시: 시리얼 상태 변경
7. 성공 알림: "검수가 완료되었습니다"
8. 모달 닫기
9. 목록 갱신

---

### 8.5 [취소] 버튼
**동작:**
- 모달 닫기
- 검수 데이터 저장 안 함

---

## 9. 유효성 검증 규칙

### 9.1 입고 등록 필수 필드
- 입고 유형
- 창고
- 입고일
- 유형별 참조 번호 (PO/출고/AS)
- 자재 1개 이상

---

### 9.2 검수 수량 검증
```
정상 수량 + 불량 수량 = 입고 수량
```
- 불일치 시: "검수 수량이 입고 수량과 일치하지 않습니다"

---

### 9.3 불량 사유 필수
- 불량 수량 > 0인 경우
- 불량 사유 필수 입력
- 미입력 시: "불량 사유를 입력해주세요"

---

## 10. 상태 정의

### 10.1 입고 상태

| 상태 | 설명 |
|------|------|
| 대기 | 입고 등록 완료, 검수 전 |
| 검수중 | 검수 진행 중 |
| 완료 | 검수 완료, 재고 반영 완료 |

---

### 10.2 상태 흐름
```
대기 → 검수중 → 완료
```

**자동 상태 변경:**
- 입고 등록 시: "검수중"
- 검수 완료 시: "완료"

---

## 11. 에러 처리

### 11.1 사용자 입력 오류

| 상황 | 메시지 | 동작 |
|------|--------|------|
| 필수 필드 누락 | "필수 항목을 입력해주세요" | 해당 필드 포커스 |
| 자재 미추가 | "입고할 자재를 추가해주세요" | - |
| 검수 수량 불일치 | "검수 수량이 입고 수량과 일치하지 않습니다" | 수량 필드 포커스 |
| 불량 사유 미입력 | "불량 사유를 입력해주세요" | 사유 필드 포커스 |

---

## 12. 비즈니스 규칙

### 12.1 입고 번호 생성
- 자동 생성 (수동 입력 불가)
- 형식: IN + - + YYYY + - + 일련번호
- 예: IN-2024-050
- 연도별 순번 관리

---

### 12.2 재고 반영
**검수 완료 시:**
- 정상 수량: 해당 창고 재고 증가
- 불량 수량: 불량 재고로 분류 또는 폐기 처리

**재고 증가 시점:**
- 검수 완료 버튼 클릭 시
- 상태 "완료" 변경과 동시 처리

---

### 12.3 AS 회수 처리
**현장 회수 입고 시:**
- AS 회수 체크 시: 해당 시리얼 상태 변경 (파손/불량 등)
- 미사용 반납 시: 시리얼 상태 유지 (정상)

---

### 12.4 입고 유형별 처리

**구매 입고:**
- PO 기반 입고
- 공급사 정보 자동 입력
- 발주 수량과 입고 수량 비교

**현장 회수:**
- 출고 기반 회수
- AS 회수 여부 구분
- 미사용 자재는 정상 재고로 반영

**AS 입고:**
- AS 번호 기반 입고
- AS 창고로 입고
- 시리얼 상태 자동 변경

**기타 입고:**
- 임의 입고 (증정품, 샘플 등)
- 공급사 직접 입력

---

## 13. 화면 흐름도

### 13.1 입고 등록 흐름
```
[+ 신규 입고] 클릭
    ↓
신규 입고 모달 오픈
    ↓
입고 유형 선택
    ↓
참조 번호 선택 (PO/출고/AS)
    ↓
자재 목록 자동 로드 또는 수동 추가
    ↓
입고 수량 입력
    ↓
창고 선택
    ↓
[입고 등록] 클릭
    ↓
필수 필드 검증
    ↓
자재 검증
    ↓
입고 등록 처리
    ↓
입고 번호 자동 생성
    ↓
상태: "검수중" 설정
    ↓
성공 알림
    ↓
목록 갱신
```

---

### 13.2 입고 검수 흐름
```
[검수] 버튼 클릭
    ↓
입고 검수 모달 오픈
    ↓
자재별 검수 수량 입력
    ↓
정상 수량 / 불량 수량 입력
    ↓
불량 사유 입력 (불량 시)
    ↓
AS 회수 체크 (회수 시)
    ↓
[검수 완료] 클릭
    ↓
수량 검증
    ↓
불량 사유 검증
    ↓
검수 완료 처리
    ↓
상태: "완료" 변경
    ↓
재고 반영 (정상/불량 분리)
    ↓
AS 회수 처리 (해당 시)
    ↓
성공 알림
    ↓
목록 갱신
```

---

## 14. 개발 체크리스트

### 14.1 필수 구현 사항
- [ ] 입고 목록 조회 (페이징)
- [ ] 검색 (입고번호/PO/자재명)
- [ ] 다중 필터 (유형/상태/창고)
- [ ] 신규 입고 모달
- [ ] 유형별 Autocomplete (PO/출고/AS)
- [ ] 입고 검수 모달
- [ ] 검수 완료 시 재고 반영
- [ ] 입고 상세 모달

---

### 14.2 유효성 검증
- [ ] 필수 필드 검증
- [ ] 자재 1개 이상 검증
- [ ] 검수 수량 = 입고 수량 검증
- [ ] 불량 사유 필수 검증 (불량 시)

---

### 14.3 사용자 경험
- [ ] 유형별 동적 필드 표시
- [ ] Autocomplete 반응 빠르게
- [ ] 검수 수량 자동 계산
- [ ] 성공/실패 알림 명확히

---

### 14.4 비즈니스 로직
- [ ] 입고 번호 자동 생성
- [ ] 검수 완료 시 재고 자동 증가
- [ ] 상태 자동 변경
- [ ] AS 회수 시리얼 상태 변경

---

## 15. 주의사항

### 15.1 반드시 지켜야 할 사항
1. **검수 수량 일치** ⭐⭐⭐
   - 정상 + 불량 = 입고 수량
   - 필수 검증
   
2. **재고 반영 시점**
   - 검수 완료 시에만 재고 증가
   - 입고 등록 시에는 재고 미반영
   
3. **불량품 처리**
   - 불량 수량 별도 관리
   - 불량 사유 필수 기록

---

### 15.2 사용자 경험 개선
1. 유형 선택 시 관련 필드만 표시
2. Autocomplete 검색 빠르게
3. 검수 수량 자동 계산 지원
4. 에러 메시지 명확히

---

### 15.3 데이터 일관성
1. 입고 수량과 검수 수량 일치
2. 재고 증가 시점 명확히
3. 참조 번호 연결 정확히
4. AS 회수 시리얼 상태 동기화

---

## 16. 참고 사항

### 16.1 향후 개선 사항
- 바코드/QR 스캔 검수
- Excel 업로드 일괄 입고
- 입고 취소 기능
- 입고 수정 기능
- 입고서 자동 생성 (PDF)

---

### 16.2 관련 화면
- 발주 관리: 구매 입고 연동
- 출고 관리: 현장 회수 연동
- AS 관리: AS 입고 연동
- 재고 관리: 재고 증가 반영
- 시리얼 재고: AS 회수 상태 변경

---

**작성일:** 2026-02-11  
**작성자:** 기획팀  
**버전:** 1.0 (비즈니스 로직 중심)
