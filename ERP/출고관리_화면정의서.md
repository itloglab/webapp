# 출고 관리 - 화면 정의서

## 1. 화면 개요

### 1.1 기본 정보
- **화면명**: 출고 관리
- **목적**: 출고 목록 조회, 출고 등록, 출고 상세 확인

---

## 2. 탭 구조

### 2.1 탭 구성
**2개의 탭으로 구성:**
- 출고 목록 (기본)
- 출고 등록

**탭 전환:**
- 탭 클릭 시 해당 컨텐츠 표시
- 이전 탭 숨김
- 활성 탭 스타일 변경

---

# 탭 1: 출고 목록

## 3. 초기 로드

### 3.1 초기 데이터 로드
- 전체 출고 목록 조회
- 최신순 정렬
- 페이징: 50건씩

### 3.2 초기 화면 상태
- 상태 필터: "상태 전체" 선택
- 현장 필터: "현장 전체" 선택
- 기간 필터: "기간 전체" 선택
- 검색어: 비어있음
- 요약 영역: 통계 표시

---

## 4. 검색/필터 영역

### 4.1 상태 필터
**필터 옵션:**
- 상태 전체 (기본값)
- 완료
- 진행중

**동작:**
- 드롭다운 선택 시 즉시 필터 적용

---

### 4.2 현장 필터
**필터 옵션:**
- 현장 전체 (기본값)
- 등록된 현장 목록

**동작:**
- 특정 현장 선택 시 해당 현장의 출고만 표시

---

### 4.3 기간 필터
**필터 옵션:**
- 기간 전체 (기본값)
- 오늘
- 이번 주
- 이번 달

**동작:**
- 선택한 기간의 출고만 표시

---

### 4.4 검색 기능
**검색 대상:**
- 출고 번호
- 발주 번호
- 자재명
- 통합 검색 (OR 조건)

**[검색] 버튼 클릭 시:**
- 검색 실행
- 결과 테이블 업데이트

---

### 4.5 초기화 기능
**[초기화] 버튼 클릭 시:**
- 모든 필터 "전체"로 리셋
- 검색 입력 필드 초기화
- 전체 목록 재조회

---

## 5. 요약 영역

### 5.1 통계 표시
```
전체: 85건 | 완료: 72건 | 진행중: 13건 | 초과출고: 3건
```

**통계 항목:**
- **전체**: 전체 출고 건수
- **완료**: 완료된 출고 건수
- **진행중**: 진행 중인 출고 건수
- **초과출고**: 발주 수량을 초과한 출고 건수

**특징:**
- 실시간 업데이트 (출고 시)

---

### 5.2 [+ 신규 출고] 버튼
**위치:** 요약 영역 우측

**클릭 시:**
- 출고 등록 탭으로 전환

---

## 6. 목록 테이블

### 6.1 컬럼 구조
| 컬럼명 | 표시 내용 | 비고 |
|--------|----------|------|
| 출고 번호 | OUT-2024-050 | 굵게 표시 |
| 발주 | IT260115-01 | 링크 |
| 현장 | 강남 오피스텔 | |
| 자재 | 3종 54개 | |
| 출고일 | 2024-02-03 | |
| 담당자 | 이출고 | |
| 상태 | 뱃지 (완료/진행중) | 색상 구분 |
| 작업 | - | |

---

### 6.2 상태 뱃지
**상태별 표시:**
| 상태 | 조건 | 색상 |
|------|------|------|
| 완료 | 출고 완료 처리 | 초록색 |
| 진행중 | 출고 진행 중 | 주황색 |

---

### 6.3 발주 링크
**클릭 시:**
- 발주 상세 화면으로 이동

---

### 6.4 행 클릭
**트리거:** 테이블 행 클릭

**동작:**
- 출고 상세 모달 오픈
- 출고 정보 및 자재 목록 로드

---

## 7. 출고 상세 모달

### 7.1 오픈 조건
- 테이블 행 클릭

---

### 7.2 표시 정보

**출고 기본 정보:**
- 출고 번호
- 발주 번호 (링크)
- 현장
- 출고일
- 상태
- 담당자
- 비고

**출고 자재 목록 (테이블):**
| 자재 코드 | 자재명 | 시리얼 번호 | 출고 수량 | 품질 구분 | 비고 |
|----------|--------|------------|----------|----------|------|

**시리얼 번호:**
- 시리얼 관리 자재인 경우 표시
- 복수 시리얼: "CAM-001, CAM-002 외 3개"

---

### 7.3 [닫기] 버튼
**동작:**
- 모달 닫기

---

### 7.4 [출고서 다운로드] 버튼 (선택)
**동작:**
- 출고서 Excel 다운로드
- 파일명: 출고서_{출고번호}.xlsx

---

# 탭 2: 출고 등록

## 8. 출고 등록 탭

### 8.1 탭 오픈
**트리거:**
- [출고 등록] 탭 클릭
- 목록의 [+ 신규 출고] 버튼 클릭

---

## 9. 발주 선택 영역

### 9.1 발주 검색
**위치:** 상단

**입력 필드:**
- 발주 검색 (Autocomplete)

**검색 동작:**
1. 입력 시 자동완성 드롭다운 표시
2. 발주 목록 표시 (발주번호, 견적명, 현장)
3. 발주 선택

---

### 9.2 선택된 발주 정보 표시
**선택 시 표시:**
- 발주 번호
- 견적명
- 본사
- 현장
- 발주일
- 출고 진행률

---

## 10. 출고 기본 정보 입력

### 10.1 입력 필드

**필수 입력 (*):**
- 발주* (위 검색으로 선택)
- 출고일*
- 담당자*

**선택 입력:**
- 비고

---

## 11. 출고 자재 목록

### 11.1 자재 목록 테이블

**컬럼:**
| 자재 코드 | 자재명 | 발주 수량 | 기출고 | 잔여 | 출고 수량 | 시리얼 | 품질 | 작업 |
|----------|--------|----------|--------|------|----------|--------|------|------|

**표시 정보:**
- **발주 수량**: 발주서의 자재 수량
- **기출고**: 이미 출고된 수량
- **잔여**: 발주 수량 - 기출고
- **출고 수량**: 이번 출고 수량 (입력)
- **시리얼**: 시리얼 선택 버튼 (시리얼 관리 자재만)
- **품질**: 신품/중고 선택 (드롭다운)
- **작업**: [X] 삭제 버튼

---

### 11.2 출고 수량 입력

**입력 방식:**
- 직접 입력

**기본값:**
- 잔여 수량

**검증:**
- 출고 수량 ≤ 잔여 수량 (일반)
- 초과 출고 허용 시: 경고 표시하되 등록 가능

---

### 11.3 시리얼 선택 (시리얼 관리 자재)

**[시리얼 선택] 버튼 클릭 시:**
- 시리얼 선택 모달 오픈
- 출고 가능한 시리얼 목록 표시
- 출고 수량만큼 시리얼 선택

**시리얼 선택 모달:**
- 자재별 시리얼 목록 표시
- 체크박스로 다중 선택
- 선택 개수 = 출고 수량

---

### 11.4 품질 구분 선택

**옵션:**
- 신품
- 중고

**기본값:**
- 신품

---

### 11.5 [+ 자재 추가] 버튼

**동작:**
1. 자재 검색 인라인 입력 표시
2. Autocomplete로 자재 검색
3. 자재 선택 시 테이블에 행 추가
4. 출고 수량 입력

**주의:**
- 발주 외 자재 추가 가능 (초과 출고)
- 초과 출고 시 경고 표시

---

## 12. 출고 요약

### 12.1 표시 정보
```
총 자재 종류: 3종
총 출고 수량: 54개
초과 출고 자재: 1종
```

**자동 계산:**
- 자재 추가/삭제/수량 변경 시 실시간 갱신

**초과 출고 경고:**
- 초과 출고 자재가 있을 경우 빨간색으로 표시
- "초과 출고 자재가 있습니다. 확인해주세요."

---

## 13. [출고 등록] 버튼

### 13.1 유효성 검증

**1단계: 필수 필드 검증**
- 발주 선택 확인
- 출고일 입력 확인
- 담당자 입력 확인

**2단계: 자재 검증**
- 자재 1개 이상 추가 확인
- 모든 자재 출고 수량 1 이상 확인

**3단계: 시리얼 검증 (시리얼 관리 자재)**
- 시리얼 선택 개수 = 출고 수량 확인
- 불일치 시: "시리얼 선택 개수가 출고 수량과 일치하지 않습니다"

**4단계: 재고 검증**
- 출고 수량 ≤ 가용 재고 확인
- 재고 부족 시: "재고가 부족합니다. 가용 재고: XX개"

**5단계: 초과 출고 확인**
- 초과 출고 자재가 있을 경우 확인 메시지
- "발주 수량을 초과하는 자재가 있습니다. 출고하시겠습니까?"

---

### 13.2 동작 순서
1. 필수 필드 검증
2. 자재 검증
3. 시리얼 검증 (해당 시)
4. 재고 검증
5. 초과 출고 확인 (해당 시)
6. 출고 등록 처리
7. 출고 번호 자동 생성
   - 형식: OUT + - + YYYY + - + 일련번호
   - 예: OUT-2024-050
8. 재고 차감 처리
9. 시리얼 위치 변경 (해당 시)
10. 발주 진행률 자동 갱신
11. 성공 알림: "출고가 등록되었습니다"
12. 출고 목록 탭으로 전환
13. 목록 갱신

---

### 13.3 [취소] 버튼
**동작:**
- 확인 메시지: "작성 중인 내용이 사라집니다. 취소하시겠습니까?"
- 확인 시: 출고 목록 탭으로 전환
- 취소 시: 현재 탭 유지

---

## 14. 시리얼 선택 모달

### 14.1 모달 오픈
**트리거:**
- 자재 행의 [시리얼 선택] 버튼 클릭

---

### 14.2 표시 정보
**자재 정보 (읽기 전용):**
- 자재 코드
- 자재명
- 출고 수량

**시리얼 목록 (테이블):**
| 선택 | 시리얼 번호 | 상태 | 위치 | 입고일 | 품질 |
|------|------------|------|------|--------|------|

**필터:**
- 출고 가능한 시리얼만 표시
- 상태: 정상
- 위치: 본사 창고

---

### 14.3 시리얼 선택
**선택 방식:**
- 체크박스로 다중 선택

**선택 제한:**
- 선택 개수 = 출고 수량
- 초과 선택 시: "출고 수량만큼만 선택 가능합니다"

---

### 14.4 [확인] 버튼
**유효성 검증:**
- 선택 개수 = 출고 수량 확인
- 불일치 시: "출고 수량만큼 시리얼을 선택해주세요"

**동작:**
1. 선택 개수 검증
2. 선택된 시리얼 저장
3. 자재 행에 시리얼 표시
4. 모달 닫기

---

### 14.5 [취소] 버튼
**동작:**
- 모달 닫기
- 선택 취소

---

## 15. 유효성 검증 규칙

### 15.1 출고 등록 필수 필드
- 발주 선택
- 출고일
- 담당자
- 자재 1개 이상

---

### 15.2 출고 수량 검증
- 출고 수량 ≥ 1
- 출고 수량 ≤ 가용 재고
- 초과 시: "재고가 부족합니다. 가용 재고: XX개"

---

### 15.3 시리얼 선택 검증
- 시리얼 관리 자재인 경우
- 선택 개수 = 출고 수량
- 불일치 시: "시리얼 선택 개수가 출고 수량과 일치하지 않습니다"

---

### 15.4 초과 출고 경고
- 출고 수량 > 잔여 발주 수량
- 경고 메시지: "발주 수량을 초과하는 자재가 있습니다. 출고하시겠습니까?"
- 확인 시 출고 허용

---

## 16. 상태 정의

### 16.1 출고 상태

| 상태 | 설명 |
|------|------|
| 진행중 | 출고 진행 중 |
| 완료 | 출고 완료 |

**초기 상태:**
- 출고 등록 시: "완료"

---

## 17. 에러 처리

### 17.1 사용자 입력 오류

| 상황 | 메시지 | 동작 |
|------|--------|------|
| 필수 필드 누락 | "필수 항목을 입력해주세요" | 해당 필드 포커스 |
| 자재 미추가 | "출고할 자재를 추가해주세요" | - |
| 재고 부족 | "재고가 부족합니다. 가용 재고: XX개" | 수량 필드 포커스 |
| 시리얼 개수 불일치 | "시리얼 선택 개수가 출고 수량과 일치하지 않습니다" | - |

---

## 18. 비즈니스 규칙

### 18.1 출고 번호 생성
- 자동 생성 (수동 입력 불가)
- 형식: OUT + - + YYYY + - + 일련번호
- 예: OUT-2024-050
- 연도별 순번 관리

---

### 18.2 재고 차감
**출고 등록 시:**
- 출고 수량만큼 재고 차감
- 시리얼 관리 자재: 선택된 시리얼 상태 변경 (출고)
- 일반 자재: 수량 차감

**재고 차감 시점:**
- 출고 등록 버튼 클릭 시 즉시

---

### 18.3 시리얼 위치 변경
**출고 시:**
- 선택된 시리얼의 위치 변경
- 본사 창고 → 현장
- 시리얼 이동 이력 기록

---

### 18.4 발주 진행률 자동 갱신
**출고 시:**
```
발주 진행률 = (총 출고 수량 / 총 발주 수량) × 100
```

**자동 계산:**
- 출고 등록 시마다 재계산
- 발주 목록에 실시간 반영

---

### 18.5 초과 출고 허용
**정책:**
- 초과 출고 허용 (경고 표시)
- 발주 외 자재 출고 가능
- 초과 출고 건수 별도 추적

**사유:**
- 현장 긴급 요청
- 소모품 추가
- 예비 자재

---

## 19. 화면 흐름도

### 19.1 출고 등록 흐름
```
[출고 등록] 탭 클릭
    ↓
발주 검색 (Autocomplete)
    ↓
발주 선택
    ↓
발주 정보 자동 입력
    ↓
발주 자재 목록 자동 로드
    ↓
출고일/담당자 입력
    ↓
출고 수량 입력
    ↓
시리얼 선택 (시리얼 관리 자재)
    ↓
품질 구분 선택
    ↓
(자재 추가/수정 반복)
    ↓
출고 요약 확인
    ↓
[출고 등록] 클릭
    ↓
필수 필드 검증
    ↓
자재 검증
    ↓
시리얼 검증 (해당 시)
    ↓
재고 검증
    ↓
초과 출고 확인 (해당 시)
    ↓
출고 등록 처리
    ↓
출고 번호 자동 생성
    ↓
재고 차감
    ↓
시리얼 위치 변경 (해당 시)
    ↓
발주 진행률 자동 갱신
    ↓
성공 알림
    ↓
출고 목록 탭 전환
    ↓
목록 갱신
```

---

### 19.2 시리얼 선택 흐름
```
[시리얼 선택] 버튼 클릭
    ↓
시리얼 선택 모달 오픈
    ↓
출고 가능 시리얼 목록 표시
    ↓
체크박스로 시리얼 선택
    ↓
선택 개수 = 출고 수량 확인
    ↓
[확인] 클릭
    ↓
선택 개수 검증
    ↓
선택된 시리얼 저장
    ↓
자재 행에 시리얼 표시
    ↓
모달 닫기
```

---

## 20. 개발 체크리스트

### 20.1 필수 구현 사항

**탭 1: 출고 목록**
- [ ] 출고 목록 조회 (페이징)
- [ ] 검색 (출고번호/발주번호/자재명)
- [ ] 다중 필터 (상태/현장/기간)
- [ ] 출고 상세 모달

**탭 2: 출고 등록**
- [ ] 발주 Autocomplete 검색
- [ ] 발주 자재 목록 자동 로드
- [ ] 시리얼 선택 모달
- [ ] 출고 요약 자동 계산
- [ ] 재고 차감 처리
- [ ] 시리얼 위치 변경
- [ ] 발주 진행률 자동 갱신

---

### 20.2 유효성 검증
- [ ] 필수 필드 검증
- [ ] 자재 1개 이상 검증
- [ ] 재고 부족 검증
- [ ] 시리얼 개수 일치 검증
- [ ] 초과 출고 확인

---

### 20.3 사용자 경험
- [ ] 탭 전환 부드럽게
- [ ] Autocomplete 반응 빠르게
- [ ] 실시간 요약 갱신
- [ ] 초과 출고 경고 명확히
- [ ] 성공/실패 알림 명확히

---

### 20.4 비즈니스 로직
- [ ] 출고 번호 자동 생성
- [ ] 재고 자동 차감
- [ ] 시리얼 위치 자동 변경
- [ ] 발주 진행률 자동 계산
- [ ] 초과 출고 허용 및 추적

---

## 21. 주의사항

### 21.1 반드시 지켜야 할 사항
1. **재고 차감 정확성** ⭐⭐⭐
   - 출고 시 즉시 재고 차감
   - 재고 부족 시 출고 불가
   
2. **시리얼 선택 정확성**
   - 선택 개수 = 출고 수량
   - 시리얼 위치 자동 변경
   
3. **발주 진행률 정확성**
   - 출고 시 즉시 갱신
   - 실시간 반영

---

### 21.2 사용자 경험 개선
1. 발주 검색 빠르게
2. 자재 목록 자동 로드
3. 실시간 요약 갱신
4. 초과 출고 경고 명확히

---

### 21.3 데이터 일관성
1. 출고 수량과 재고 차감 일치
2. 시리얼 선택과 출고 수량 일치
3. 발주 진행률과 출고 현황 일치
4. 시리얼 위치와 출고 정보 일치

---

## 22. 참고 사항

### 22.1 향후 개선 사항
- 출고서 자동 생성 (PDF)
- 바코드/QR 스캔 출고
- 출고 수정 기능
- 출고 취소 기능
- 일괄 출고 (Excel 업로드)

---

### 22.2 관련 화면
- 발주 관리: 진행률 연동
- 재고 관리: 재고 차감
- 시리얼 재고: 위치 변경
- 견적 관리: 출고 현황 조회
- 현장 통합 현황: 출고 이력 조회

---

**작성일:** 2026-02-11  
**작성자:** 기획팀  
**버전:** 1.0 (비즈니스 로직 중심)
