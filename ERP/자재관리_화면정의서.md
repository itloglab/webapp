# 자재 관리 - 화면 정의서

## 1. 화면 개요

### 1.1 기본 정보

- **화면명**: 자재 관리
- **목적**: 재고 현황 조회, 시리얼 재고 관리, 재고 변동 이력 조회, 재고 실사

---

## 2. 탭 구조

### 2.1 탭 구성

**4개의 탭으로 구성:**
- 재고 현황 (기본)
- 시리얼 재고 현황
- 재고 변동 이력
- 재고 실사

**탭 전환:**
- 탭 클릭 시 해당 컨텐츠 표시
- 이전 탭 숨김
- 활성 탭 스타일 변경

---

# 탭 1: 재고 현황

## 3. 초기 로드

### 3.1 초기 데이터 로드
- 전체 자재 재고 목록 조회
- 자재 코드순 정렬
- 페이징: 50건씩

### 3.2 초기 화면 상태
- 카테고리 필터: "카테고리 전체" 선택
- 창고 필터: "창고 전체" 선택
- 상태 필터: "상태 전체" 선택
- 검색어: 비어있음
- 안전재고 미달만 체크박스: 미선택
- 요약 영역: 통계 표시
  - 총 자재 / 총 재고 / 안전재고 미달 / 가용 재고

---

## 4. 검색/필터 영역

### 4.1 카테고리 필터

**필터 옵션:**
- 카테고리 전체 (기본값)
- CCTV
- 네트워크
- 기타 카테고리...

**동작:**
- 드롭다운 선택 시 즉시 필터 적용
- 선택한 카테고리의 자재만 목록에 표시

---

### 4.2 창고 필터

**필터 옵션:**
- 창고 전체 (기본값)
- 본사 창고
- 강남 창고
- 기타 창고...

**동작:**
- 드롭다운 선택 시 즉시 필터 적용

---

### 4.3 상태 필터

**필터 옵션:**
- 상태 전체 (기본값)
- 정상
- 부족 (안전재고 미달)

**동작:**
- 드롭다운 선택 시 즉시 필터 적용

---

### 4.4 검색 기능

**검색 대상:**
- 자재명
- 자재 코드
- 통합 검색 (OR 조건)

**[검색] 버튼 클릭 시:**

**동작 순서:**
1. 검색어 입력 검증 (선택)
2. 검색 실행
3. 결과 테이블 업데이트

**검색 결과:**
- 매칭된 자재만 표시
- 결과 없으면: "검색 결과가 없습니다" 메시지

---

### 4.5 안전재고 미달만 체크박스

**위치:** 검색 입력 우측

**체크 시:**
- 안전재고 미달 자재만 필터링
- 다른 필터와 AND 조건으로 작동

**미체크 시:**
- 전체 자재 표시

---

### 4.6 초기화 기능

**[초기화] 버튼 클릭 시:**
- 모든 필터 드롭다운 "전체"로 리셋
- 검색 입력 필드 초기화
- 안전재고 미달만 체크박스 해제
- 전체 목록 재조회

---

## 5. 요약 영역

### 5.1 통계 표시

```
총 자재: 1,234개 | 총 재고: 15,678개 | 안전재고 미달: 8개 | 가용 재고: 14,523개
```

**특징:**
- 필터/검색과 무관하게 전체 통계 유지
- 실시간 업데이트 (입고/출고/조정 시)

**통계 항목:**
- **총 자재**: 등록된 자재 품목 수
- **총 재고**: 전체 자재 재고 수량 합계
- **안전재고 미달**: 현재 재고가 안전재고 미만인 자재 개수
- **가용 재고**: 총 재고 - 예약 수량

---

### 5.2 [📝 재고 조정] 버튼

**위치:** 요약 영역 우측

**클릭 시:**
- 재고 조정 모달 오픈
- 폼 필드 초기화

---

### 5.3 [📥 Excel 다운로드] 버튼

**위치:** 재고 조정 버튼 우측

**클릭 시:**
- 현재 필터된 재고 목록 Excel 다운로드
- 파일명: 재고현황_{날짜}.xlsx

---

## 6. 목록 테이블

### 6.1 컬럼 구조

| 컬럼명 | 표시 내용 | 비고 |
|--------|----------|------|
| 자재 코드 | CAM-001 | 굵게 표시 |
| 자재명 | IP카메라 2MP | |
| 규격 | 2MP, IP67 | 회색 작은 글씨 |
| 창고 위치 | 본사 A-01-01 | |
| 재고 | 25개 + (신품 20 · 중고 5) | 상세 표시 |
| 예약 | 5 | 예약된 수량 |
| 가용 | 20 | 재고 - 예약 |
| 상태 | 뱃지 (정상/안전재고 미달) | 색상 구분 |
| 작업 | [조정] 버튼 | |

---

### 6.2 재고 표시 형식

**2줄 표시:**
```
25
신품 20 · 중고 5
```

**1줄 표시:**
- 굵은 글씨: 총 재고 수량
- 작은 회색 글씨: 신품/중고 수량 상세

---

### 6.3 행 클릭

**트리거:** 테이블 행 클릭

**동작:**
- 해당 자재의 상세 모달 오픈
- 재고 상세 정보 로드

**예외:**
- "작업" 컬럼의 버튼 클릭 시에는 행 클릭 무시

---

### 6.4 상태 뱃지

**상태별 표시:**

| 상태 | 조건 | 색상 |
|------|------|------|
| 정상 | 현재 재고 ≥ 안전재고 | 초록색 |
| 안전재고 미달 | 현재 재고 < 안전재고 | 주황색 |

---

### 6.5 [조정] 버튼

**위치:** 작업 컬럼

**클릭 시:**
- 재고 조정 모달 오픈
- 해당 자재 정보 자동 입력
- 현재 재고 표시

---

## 7. 재고 상세 모달

### 7.1 오픈 조건
- 테이블 행 클릭

---

### 7.2 표시 정보

**자재 기본 정보:**
- 자재 코드
- 자재명
- 카테고리
- 제조사
- 단가

**재고 정보:**
- 창고
- 위치
- 로트 번호
- 총 재고
- 예약 수량
- 가용 수량
- 안전 재고

**발주 정보:**
- 안전재고
- 납기 소요일
- 발주 안내 메시지

---

### 7.3 [닫기] 버튼

**동작:**
- 모달 닫기

---

## 8. 재고 조정 모달

### 8.1 모달 오픈

**트리거:**
- [📝 재고 조정] 버튼 클릭 (요약 영역)
- [조정] 버튼 클릭 (목록 행)

**초기 데이터:**
- 행의 [조정] 버튼 클릭 시: 해당 자재 정보 자동 입력
- 요약 영역 버튼 클릭 시: 자재 선택 필요

---

### 8.2 입력 필드

**필수 입력 (*):**
- 자재* (검색 입력)
- 조정 유형* (증가/감소/재고 설정)
- 조정 수량*
- 조정 사유* (드롭다운)

**선택 입력:**
- 상세 사유 (텍스트)
- 조정 일시 (기본값: 현재 시간)

---

### 8.3 현재 재고 정보 박스

**자재 선택 시 표시:**
- 현재 재고: 00개
- 창고: 본사 창고
- 위치: A-01-01

**자재 미선택 시:**
- 숨김

---

### 8.4 조정 유형

**옵션:**
- 증가 (+): 현재 재고에 수량 추가
- 감소 (-): 현재 재고에서 수량 차감
- 재고 설정 (=): 재고를 특정 수량으로 설정

**동작:**
- 증가 선택 시: 조정 후 재고 = 현재 재고 + 조정 수량
- 감소 선택 시: 조정 후 재고 = 현재 재고 - 조정 수량
- 재고 설정 시: 조정 후 재고 = 조정 수량

---

### 8.5 조정 사유 (드롭다운)

**옵션:**
- 실사 조정
- 분실
- 파손
- 오입력 수정
- 기타

**필수 선택**

---

### 8.6 [조정 완료] 버튼

**유효성 검증:**

**1단계: 필수 필드 검증**
- 자재 선택 확인
- 조정 유형 선택 확인
- 조정 수량 입력 확인 (1 이상)
- 조정 사유 선택 확인

**2단계: 감소 수량 검증**
- 조정 유형이 "감소"인 경우
- 조정 수량 ≤ 현재 재고 확인
- 초과 시: "재고가 부족합니다" 알림

**동작 순서:**
1. 필수 필드 검증
2. 감소 수량 검증 (해당 시)
3. 재고 조정 처리
4. 재고 변동 이력 자동 기록
5. 성공 알림: "재고가 조정되었습니다"
6. 모달 닫기
7. 목록 갱신 (해당 행 업데이트)

**이력 기록:**
- 조정 유형, 수량, 사유, 상세 사유
- 변경 전 재고, 변경 후 재고
- 조정자, 조정 일시

---

### 8.7 [취소] 버튼

**동작:**
- 확인 메시지: "조정을 취소하시겠습니까?"
- 확인 시: 모달 닫기
- 취소 시: 모달 유지

---

# 탭 2: 시리얼 재고 현황

## 9. 시리얼 재고 탭

### 9.1 초기 데이터 로드
- 전체 시리얼 재고 목록 조회
- 시리얼 번호순 정렬
- 페이징: 50건씩

### 9.2 초기 화면 상태
- 모든 필터: "전체" 선택
- 검색어: 비어있음

---

## 10. 검색/필터 영역 (시리얼)

### 10.1 검색 기능

**검색 대상:**
- 시리얼 번호
- 자재명
- 통합 검색 (OR 조건)

---

### 10.2 필터

**필터 종류:**
1. 상태 필터
   - 상태 전체 / 정상 / 파손 / 불량 / 분실
2. 소유구분 필터
   - 소유구분 전체 / 소유 / 임대 / 현장전용
3. 품질 필터
   - 품질 전체 / 신품 / 중고
4. 위치 필터
   - 위치 전체 / 본사 창고 / 현장 / AS 창고
5. 현장 필터
   - 현장 전체 / 강남 오피스텔 / 판교 공장 / ...

**동작:**
- 각 필터 독립적으로 작동
- AND 조건으로 복합 필터링

---

## 11. 요약 영역 (시리얼)

### 11.1 통계 표시

```
총 시리얼: 856개 | 정상: 720개 | 현장 운용중: 98개 | 파손/불량: 28개 | 분실: 10개
```

---

## 12. 목록 테이블 (시리얼)

### 12.1 컬럼 구조

| 컬럼명 | 표시 내용 |
|--------|----------|
| 시리얼 번호 | CAM-2024-001 |
| 자재 코드 | CAM-001 |
| 자재명 | IP카메라 2MP |
| 상태 | 뱃지 (정상/파손/불량/분실) |
| 위치 | 본사 A-01-01 / 현장명 |
| 현장 | 강남 오피스텔 / - |
| 입고일 | 2024-01-15 |
| 작업 | [상태변경] 버튼 |

---

### 12.2 행 클릭

**트리거:** 테이블 행 클릭

**동작:**
- 시리얼 상세 모달 오픈
- 시리얼 상세 정보 및 이동 이력 로드

---

### 12.3 상태 뱃지 (시리얼)

**상태별 표시:**

| 상태 | 색상 |
|------|------|
| 정상 | 초록색 |
| 외관 파손 | 주황색 |
| 기능 불량 | 빨간색 |
| 완전 파손 | 진한 빨간색 |
| 분실 | 파란색 |
| 폐기 | 회색 |

---

## 13. 시리얼 상세 모달

### 13.1 오픈 조건
- 시리얼 테이블 행 클릭

---

### 13.2 표시 정보

**시리얼 기본 정보:**
- 시리얼 번호
- 자재 코드
- 자재명
- 제조사
- 현재 상태
- 현재 위치
- 현장
- 입고일

**이동 이력 (타임라인):**
- 시간순 정렬
- 각 이력별 표시:
  - 일시
  - 이동 유형 (입고/출고/회수/AS입고/재출고 등)
  - 담당자
  - 상세 내용

**타임라인 예시:**
```
2024-01-15 10:00
입고 - 김창고
구매 입고 (PO-2024-001) → 본사 창고 A-01-01

2024-01-20 14:00
출고 - 이출고
현장 출고 (IT260115-01 - 강남 오피스텔)

2024-02-01 09:00
회수 - 김창고
현장 회수 (미사용 잔여) → 본사 창고 A-01-01
```

---

### 13.3 [상태 변경] 버튼

**위치:** 모달 하단

**클릭 시:**
- 시리얼 상태 변경 모달 오픈
- 현재 시리얼 정보 전달

---

### 13.4 [닫기] 버튼

**동작:**
- 모달 닫기

---

## 14. 시리얼 상태 변경 모달

### 14.1 모달 오픈

**트리거:**
- 시리얼 목록의 [상태변경] 버튼 클릭
- 시리얼 상세 모달의 [상태 변경] 버튼 클릭

---

### 14.2 표시 정보

**현재 정보 (읽기 전용):**
- 시리얼 번호
- 자재명
- 현재 상태

---

### 14.3 입력 필드

**변경할 상태 (라디오 버튼 - Pill 형식):**
- 정상 (초록색 점)
- 외관 파손 (주황색 점)
- 기능 불량 (빨간색 점)
- 완전 파손 (진한 빨간색 점)
- 분실 (파란색 점)
- 폐기 (회색 점)

**상태 설명:**
- 정상: 사용 가능한 상태
- 외관 파손: 외관상 손상이 있으나 기능 정상
- 기능 불량: 기능상 문제가 있음
- 완전 파손: 수리 불가능한 상태
- 분실: 분실된 상태
- 폐기: 폐기 처리된 상태

**비고 (선택 입력):**
- 상태 변경 사유 입력
- 최대 500자

---

### 14.4 [상태 변경] 버튼

**유효성 검증:**
1. 변경할 상태 선택 확인
   - 미선택 시: "변경할 상태를 선택해주세요" 알림

**동작 순서:**
1. 상태 선택 검증
2. 상태 변경 처리
3. 시리얼 목록의 상태 뱃지 즉시 갱신
4. 상태 변경 이력 기록
5. 성공 알림 표시
   - "시리얼 상태가 변경되었습니다"
   - 시리얼 번호, 변경 상태 표시
   - 비고 입력 시 함께 표시
6. 모달 닫기

**이력 기록:**
- 변경 전 상태, 변경 후 상태
- 비고
- 변경자, 변경일시

---

### 14.5 [취소] 버튼

**동작:**
- 모달 닫기
- 변경사항 없음

---

# 탭 3: 재고 변동 이력

## 15. 재고 변동 이력 탭

### 15.1 초기 데이터 로드
- 최근 재고 변동 이력 조회
- 최신순 정렬
- 페이징: 50건씩

---

## 16. 검색/필터 영역 (이력)

### 16.1 검색
- 자재명 검색

### 16.2 필터
- 이동유형 필터
  - 전체 / 입고 / 출고 / 회수 / AS입고 / 재출고 / 조정 / 파손 / 분실
- 기간 필터 (선택)
  - 날짜 범위 지정

---

## 17. 요약 영역 (이력)

### 17.1 통계 표시

```
총 이력: 1,245건 | 입고: 150건 | 출고: 890건 | 회수: 120건 | 
AS입고: 45건 | 재출고: 8건 | 파손/분실: 5건
```

---

## 18. 목록 테이블 (이력)

### 18.1 컬럼 구조

| 컬럼명 | 표시 내용 |
|--------|----------|
| 일시 | 2024-02-03 14:00 |
| 이동유형 | 뱃지 (입고/출고/회수 등) |
| 자재명 | IP카메라 2MP |
| 수량 | 50개 |
| From → To | 한화테크윈 → 본사창고 |
| 현장/발주 | 링크 (발주코드/현장명) |
| 상태변경 | 미사용/초기불량 등 |
| 담당자 | 김창고 |
| 상세 | - |

---

### 18.2 이동유형 뱃지

**유형별 색상:**

| 이동유형 | 색상 |
|----------|------|
| 입고 | 초록색 |
| 출고 | 파란색 |
| 회수 | 파란색 |
| AS입고 | 주황색 |
| 재출고 | 파란색 |
| 분실 | 빨간색 |
| 파손 | 주황색 |
| 조정 | 회색 |

---

### 18.3 현장/발주 링크

**표시 내용:**
- 발주 코드 (클릭 시 발주 상세로 이동)
- 현장명 (해당 시)
- AS 코드 (해당 시)

---

# 탭 4: 재고 실사

## 19. 재고 실사 탭

### 19.1 개요
- 정기/수시 재고 실사 진행
- 실사 결과 기록 및 조정

### 19.2 주요 기능
- 실사 시작 (새 실사 생성)
- 실사 진행 (자재별 실사)
- 실사 완료 (차이 조정)
- 실사 이력 조회

**상세 스펙은 추후 협의**

---

## 20. 유효성 검증 규칙

### 20.1 재고 조정

**필수 필드:**
- 자재 선택
- 조정 유형 선택
- 조정 수량 (1 이상)
- 조정 사유 선택

**감소 수량 검증:**
- 조정 유형이 "감소"인 경우
- 조정 수량 ≤ 현재 재고
- 초과 시: "재고가 부족합니다" 알림

---

### 20.2 시리얼 상태 변경

**필수 필드:**
- 변경할 상태 선택

**비고:**
- 선택사항

---

## 21. 상태 정의

### 21.1 재고 상태

**재고 현황 상태:**

| 상태 | 조건 |
|------|------|
| 정상 | 현재 재고 ≥ 안전재고 |
| 안전재고 미달 | 현재 재고 < 안전재고 |

---

### 21.2 시리얼 상태

**시리얼별 상태:**

| 상태 | 설명 |
|------|------|
| 정상 | 사용 가능한 정상 상태 |
| 외관 파손 | 외관 손상, 기능 정상 |
| 기능 불량 | 기능상 문제 있음 |
| 완전 파손 | 수리 불가 |
| 분실 | 분실 처리 |
| 폐기 | 폐기 처리 완료 |

---

## 22. 에러 처리

### 22.1 사용자 입력 오류

| 상황 | 메시지 | 동작 |
|------|--------|------|
| 필수 필드 누락 | "필수 항목을 입력해주세요" | 해당 필드 포커스 |
| 조정 수량 초과 | "재고가 부족합니다" | 수량 필드 포커스 |
| 상태 미선택 | "변경할 상태를 선택해주세요" | - |

---

### 22.2 시스템 오류

| 상황 | 메시지 |
|------|--------|
| 네트워크 오류 | "네트워크 연결을 확인해주세요" |
| 서버 오류 | "일시적 오류입니다. 잠시 후 시도해주세요" |
| 권한 없음 | "접근 권한이 없습니다" |

---

## 23. 비즈니스 규칙

### 23.1 재고 계산

**재고 수량:**
```
총 재고 = 신품 수량 + 중고 수량
가용 재고 = 총 재고 - 예약 수량
```

**안전재고 미달 판정:**
```
현재 재고 < 안전재고 → "안전재고 미달" 상태
```

---

### 23.2 재고 조정

**조정 유형별 계산:**
- 증가: 조정 후 재고 = 현재 재고 + 조정 수량
- 감소: 조정 후 재고 = 현재 재고 - 조정 수량
- 재고 설정: 조정 후 재고 = 조정 수량

**이력 기록:**
- 모든 재고 조정 시 이력 자동 기록
- 조정 전/후 수량 기록
- 조정 사유, 상세 사유 기록
- 조정자, 조정 일시 기록

---

### 23.3 시리얼 상태 변경

**이력 기록:**
- 모든 상태 변경 시 이력 기록
- 변경 전/후 상태 기록
- 비고 기록
- 변경자, 변경 일시 기록

---

### 23.4 알림 규칙 (선택)

**알림 대상:**
- 안전재고 미달 시: 자재 담당자에게 알림
- 시리얼 상태 파손/불량 변경 시: 관리자에게 알림
- 대량 재고 감소 시: 관리자에게 알림

---

## 24. 화면 흐름도

### 24.1 재고 조정 흐름

```
[재고 조정] 버튼 클릭
    ↓
재고 조정 모달 오픈
    ↓
자재 선택 (자동 또는 수동)
    ↓
현재 재고 정보 표시
    ↓
조정 유형 선택
    ↓
조정 수량 입력
    ↓
조정 사유 선택
    ↓
상세 사유 입력 (선택)
    ↓
[조정 완료] 클릭
    ↓
필수 필드 검증
    ↓
감소 수량 검증 (해당 시)
    ↓
재고 조정 처리
    ↓
재고 변동 이력 기록
    ↓
성공 알림
    ↓
목록 갱신
```

---

### 24.2 시리얼 상태 변경 흐름

```
시리얼 행 클릭 또는 [상태변경] 버튼 클릭
    ↓
시리얼 상세 모달 오픈 (행 클릭 시)
또는
시리얼 상태 변경 모달 오픈 (버튼 클릭 시)
    ↓
현재 정보 표시
    ↓
변경할 상태 선택
    ↓
비고 입력 (선택)
    ↓
[상태 변경] 클릭
    ↓
상태 선택 검증
    ↓
상태 변경 처리
    ↓
상태 변경 이력 기록
    ↓
목록 뱃지 즉시 갱신
    ↓
성공 알림
```

---

## 25. 개발 체크리스트

### 25.1 필수 구현 사항

**탭 1: 재고 현황**
- [ ] 재고 목록 조회 (페이징)
- [ ] 검색 (자재명/코드)
- [ ] 다중 필터 (카테고리/창고/상태)
- [ ] 안전재고 미달만 필터
- [ ] 재고 조정 모달
- [ ] 재고 상세 모달
- [ ] Excel 다운로드

**탭 2: 시리얼 재고 현황**
- [ ] 시리얼 목록 조회 (페이징)
- [ ] 검색 (시리얼/자재명)
- [ ] 다중 필터 (상태/소유/품질/위치/현장)
- [ ] 시리얼 상세 모달 (이동 이력)
- [ ] 시리얼 상태 변경 모달

**탭 3: 재고 변동 이력**
- [ ] 이력 목록 조회 (페이징)
- [ ] 검색/필터
- [ ] 이동유형별 뱃지 표시

**탭 4: 재고 실사**
- [ ] 추후 협의

---

### 25.2 유효성 검증

- [ ] 재고 조정 필수 필드 검증
- [ ] 감소 수량 초과 검증
- [ ] 시리얼 상태 선택 검증

---

### 25.3 사용자 경험

- [ ] 탭 전환 부드럽게
- [ ] 검색/필터 즉시 반영
- [ ] 성공/실패 알림 명확히
- [ ] 포커스 관리
- [ ] 로딩 인디케이터 표시
- [ ] 모달 배경 클릭 시 닫기
- [ ] 행 클릭 vs 버튼 클릭 구분

---

### 25.4 비즈니스 로직

- [ ] 재고 자동 계산 (총/가용)
- [ ] 안전재고 미달 판정
- [ ] 조정 유형별 계산 (증가/감소/설정)
- [ ] 재고 변동 이력 자동 기록
- [ ] 시리얼 상태 변경 이력 기록
- [ ] 상태별 색상 구분

---

## 26. 주의사항

### 26.1 반드시 지켜야 할 사항

1. **재고 감소 시 수량 검증** ⭐⭐⭐
   - 현재 재고보다 많이 감소할 수 없음
   - 검증 실패 시 명확한 에러 메시지

2. **재고 변동 이력 누락 없이 기록**
   - 모든 조정, 입고, 출고 시 이력 기록
   - 이력 없는 재고 변동 불가

3. **안전재고 미달 알림**
   - 안전재고 미만 시 즉시 표시
   - 담당자 알림 (선택)

4. **시리얼 추적 정확성**
   - 모든 이동 이력 기록
   - 현재 위치 정확히 표시

---

### 26.2 사용자 경험 개선

1. 검색/필터 결과 즉시 반영
2. 에러 메시지 명확하고 친절하게
3. 필수 필드 표시 명확히 (*)
4. 로딩 상태 표시
5. 성공/실패 알림 일관성 있게

---

### 26.3 데이터 일관성

1. 총 재고 = 신품 + 중고
2. 가용 재고 = 총 재고 - 예약
3. 재고 변동 이력과 현재 재고 일치
4. 시리얼 위치와 재고 위치 일치

---

## 27. 참고 사항

### 27.1 향후 개선 사항

- 재고 알림 자동화
- 재고 예측 (AI)
- 바코드/QR 스캔 지원
- 모바일 앱 연동
- 대시보드 연동 (통계/차트)
- 실사 자동화 기능

---

### 27.2 관련 화면

- 입고 관리: 재고 증가
- 출고 관리: 재고 감소
- 발주 관리: 재고 부족 시 발주
- AS 관리: 시리얼 상태 변경
- 현장 통합 현황: 재고 현황 조회

---

**작성일:** 2026-02-11  
**작성자:** 기획팀  
**버전:** 1.0 (비즈니스 로직 중심)
